[使用 go 实现 PoW(Proof-of-Work)共识机制]: https://blog.csdn.net/qq_37133717/article/details/80399469
[从零开始写一个区块链（三）—— 共识机制（Proof of Work）的实现]: https://xiaozhuanlan.com/topic/9584176023
[go区块链公链实战0x01ProofOfWork]: https://www.jianshu.com/p/50262fdbd346
[Go实现区块链（二）---工作量证明]: https://www.jianshu.com/p/c55d0c79d832

## 知识点

256位的哈希值来说设定挖矿条件的方式往往是：前多少位为0 

## 什么是 Proof-of-Work



Proof-of-Work 简称 PoW，即为工作量证明。通过计算一个数值（ **nonce** ），使得拼揍上交易数据后内容的 Hash 值满足规定的上限。

在节点成功找到满足的Hash值之后，会马上对全网进行广播打包区块，网络的节点收到广播打包区块，会立刻对其进行验证。 



如果验证通过，则表明已经有节点成功解迷，自己就不再竞争当前区块打包，而是选择接受这个区块，记录到自己的账本中，然后进行下一个区块的竞争猜谜。 

网络中只有最快解谜的区块，才会添加的账本中，其他的节点进行复制，这样就保证了整个账本的唯一性。

假如节点有任何的作弊行为，都会导致网络的节点验证不通过，直接丢弃其打包的区块，这个区块就无法记录到总账本中，作弊的节点耗费的成本就白费了，因此在巨大的挖矿成本下，也使得矿工自觉自愿的遵守比特币系统的共识协议，也就确保了整个系统的安全。

## 工作量证明的优缺点

优点：完全去中心化，节点自由进出；

缺点：目前bitcoin已经吸引全球大部分的算力，其它再用Pow共识机制的区块链应用很难获得相同的算力来保障自身的安全；挖矿造成大量的资源浪费；共识达成的周期较长，不适合商业应用

## 常见的几种共识机制： 

- **工作量证明机制(Proof of Work - PoW)**：先打个简单的比方，要想知道NBA16赛季的总冠军是谁？有两种方法，一种方法是一盘一盘的观看比赛录像带，把勇士队打败所有队伍的过程从头到尾看一遍，就确定了总冠军是勇士队，这种方法虽得出了结果但却工作量巨大；而另一种方法是，直接去看16赛季的总冠军戒指，上面写的是谁的名字，就知道了总冠军队伍是谁，这种方法更快速高效！这就是POW的原理，证明人出示计算结果很难，需要巨大的计算量，但验证他的结果却很容易，所以大家都去计算，谁第一个计算出了结果，并且通过了每个人的验证，这个人就有公示信息的权利。本节将简单的对POW做一个实现。
- **权益证明机制(Proof of Stake-PoS)**：简单的说，它就像股票，一个公司谁是最大的股东，谁持有最多股票，谁说了算，因此也叫“股权证明算法”，它由持有最多（token）的人来公示最终信息。
- **拜占庭共识算法（Practical Byzantine Fault Tolerance- PBFT）**：它由区块链上的所有人投票决定，谁少于（N-1）/3个节点反对，谁就有发言权，可以获得公示信息的权利；但它跟前两种机制有区别，它也是以计算为基础，但却没有计算的奖励。

## 工作量证明的简单的例子

举个例子，给定的一个基本的字符串”Hello, world!”，

我们给出的工作量要求是，可以在这个字符串后面添加一个叫做nonce的整数值，对变更后（添加nonce)的字符串进行SHA256哈希运算，

如果得到的哈希结果（以16进制的形式表示）是以”0000”开头的，则验证通过。为了达到这个工作量证明的目标。

我们需要不停的递增nonce值，对得到的新字符串进行SHA256哈希运算。按照这个规则，我们需要经过4251次计算才能找到恰好前4位为0的哈希散列。

```
"Hello, world!0" => 1312af178c253f84028d480a6adc1e25e81caa44c749ec81976192e2ec934c64
"Hello, world!1" => e9afc424b79e4f6ab42d99c81156d3a17228d6e1eef4139be78e948a9332a7d8
"Hello, world!2" => ae37343a357a8297591625e7134cbea22f5928be8ca2a32aa475cf05fd4266b7
...
"Hello, world!4248" => 6e110d98b388e77e9c6f042ac6b497cec46660deef75a55ebc7cfdf65cc0b965
"Hello, world!4249" => c004190b822f1669cac8dc37e761cb73652e7832fb814565702245cf26ebb9e6
"Hello, world!4250" => 0000c3af42fc31103f1fdc0151fa747ff87349a4714df7cc52ea464e12dcd4e9
```

